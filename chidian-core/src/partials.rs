// TODO: Port from python impl (use fp_core crate?)